2025-10-18 15:51:58,122 - Main - INFO - Skipping data transformation step as requested.
2025-10-18 15:51:58,122 - Main - INFO - Starting required field validations.
2025-10-18 15:51:58,124 - Main - INFO - Validated required field 'EffectiveStartDate'. Found 0 empty values.
2025-10-18 15:51:58,125 - Main - INFO - Validated required field 'StartDate'. Found 0 empty values.
2025-10-18 15:51:58,127 - Main - INFO - Finished required field validations.
2025-10-18 15:51:58,128 - Main - INFO - Starting datatype validations.
2025-10-18 15:51:58,134 - Main - INFO - Finished datatype validations.
2025-10-18 15:51:58,134 - Main - INFO - Starting key values uniqueness validation.
2025-10-18 15:51:58,142 - Main - INFO - Finished key values uniqueness validation.
2025-10-18 15:51:58,142 - Main - INFO - Starting EffectiveStartDate < EffectiveEndDate validation...
2025-10-18 15:51:58,143 - Main - INFO - Completed EffectiveStartDate < EffectiveEndDate validation.
2025-10-18 15:51:58,144 - Main - INFO - Starting lookup validations.
2025-10-18 15:51:58,146 - Main - INFO - Validated lookup for 'BloodType'. Found 0 invalid values (excluding empty row data).
2025-10-18 15:51:58,147 - Main - INFO - Finished lookup validations.
2025-10-18 15:51:58,148 - Main - INFO - Starting custom validation: First row for Person Number must be 'HIRE'.
2025-10-18 15:51:58,152 - Main - INFO - Finished custom validation: First row for Person Number must be 'HIRE'.
2025-10-18 15:51:58,153 - Main - INFO - Starting validation: LegalEmployerName consistency check with reset on HIRE/TERMINATION/GT.
2025-10-18 15:51:58,153 - Main - WARNING - Missing columns for LegalEmployerName consistency validation. Skipping.
2025-10-18 15:51:58,153 - Main - INFO - Completed validation: LegalEmployerName consistency check.
2025-10-18 15:51:58,154 - Main - INFO - Starting GLOBAL TRANSFER validation (LegalEmployerName change + date continuity)...
2025-10-18 15:51:58,155 - Main - WARNING - Skipping GLOBAL TRANSFER validation due to missing columns: LegalEmployerName
2025-10-18 15:51:58,155 - Main - INFO - Completed GLOBAL TRANSFER validation.
2025-10-18 15:51:58,197 - Main - INFO - Failed records saved to C:\Users\ADMIN\Documents\GitHub\Project_Charlie_Main\Server\validation_results\failed_Worker_20251018_155158.xlsx
2025-10-18 15:51:58,206 - Main - INFO - Loaded custom validation module: uploads\Excel_Files\saved_code\Venkataraman_Test_Worker.py
2025-10-18 15:51:58,206 - Main - INFO - Found 'validate_row' function in uploads\Excel_Files\saved_code\Venkataraman_Test_Worker.py. Applying custom row-level validation.
2025-10-18 15:51:58,207 - Main - DEBUG - Applying custom validation to row 0
2025-10-18 15:51:58,208 - Main - DEBUG - Applying custom validation to row 1
2025-10-18 15:51:58,208 - Main - DEBUG - Applying custom validation to row 2
2025-10-18 15:51:58,208 - Main - DEBUG - Applying custom validation to row 3
2025-10-18 15:51:58,211 - Main - ERROR - Combined Actions is : ['HIRE', 'GLB_TRANSFER', 'REHIRE']
2025-10-18 15:51:58,212 - Main - INFO - Added source keys to passed_df. New columns added: ['METADATA', 'Worker', 'SourceSystemId', 'SourceSystemOwner']
2025-10-18 15:51:58,212 - Main - INFO - Using provided datColumnOrder: ['PersonNumber', 'EffectiveStartDate', 'EffectiveEndDate', 'BloodType', 'CorrespondenceLanguage', 'StartDate', 'DateOfBirth', 'CountryOfBirth', 'RegionOfBirth', 'TownOfBirth', 'ActionCode', 'ReasonCode']
2025-10-18 15:51:58,213 - Main - INFO - Final columns for DAT file generation (ordered): ['METADATA', 'Worker', 'SourceSystemId', 'SourceSystemOwner', 'PersonNumber', 'EffectiveStartDate', 'EffectiveEndDate', 'BloodType', 'CorrespondenceLanguage', 'StartDate', 'DateOfBirth', 'CountryOfBirth', 'RegionOfBirth', 'TownOfBirth', 'ActionCode', 'ReasonCode']
2025-10-18 15:51:58,213 - Main - INFO - Found ActionCode column: ActionCode. Calculating special counter.
2025-10-18 15:51:58,213 - Main - INFO - Special counter calculated: 0 for ActionCode values.
2025-10-18 15:51:58,214 - Main - INFO - Passed validation data saved to: C:\Users\ADMIN\Documents\GitHub\Project_Charlie_Main\Server\validation_results\Worker_passed_data_20251018_155158.dat. Special count: 0
2025-10-18 15:51:58,237 - Main - INFO - Failed validation data saved to: C:\Users\ADMIN\Documents\GitHub\Project_Charlie_Main\Server\validation_results\Worker_failed_data_20251018_155158.xlsx
